!function($){"use strict";var t=$(document);$.CVComposer=function(){this.applyEvents()},$.CVComposer.prototype={applyEvents:function(){t.on("click",".cv-composer-launch",function(){var e=$(this).closest(".wp-editor-wrap").hasClass("tmce-active")?"tmce":"html",a=$(this).closest(".wp-editor-wrap").find(".wp-editor-area").attr("id");t.data("cv-template-builder").startLoading(),new $.CVComposerModal({title:cv_composer_localize.select_shortcode_title,submit_button:!1,ajax_callback:"render_available_shortcodes",on_load:function(o){t.data("cv-template-builder").doneLoading(),o.on("click",".cv-composer-available-module",function(){var n=$(this).data("handle"),c=$(this).find("strong").html();o.trigger("cancel-modal"),t.data("cv-template-builder").startLoading(),new $.CVComposerModal({title:cv_composer_localize.add_shortcode_title.replace("%s",c),action:n,ajax_callback:"render_composer_controls",ajax_param:n,add_class:"editing-"+n,on_load:function(){t.data("cv-template-builder").doneLoading()},on_submit:function(o){var c={},i="",r,d;c.handle=n,c.attributes={},o.find("#cv-composer-form .standard-attributes .control-wrap").each(function(){switch(d=$(this),d.data("type")){case"layout":case"iconpicker":case"bg-pattern":r=d.find("[name]:checked"),c.attributes[r.attr("name")]=r.val();break;case"list":var t="";r=d.find("[name]");var e=r.data("separator");r.next().children().each(function(){t+=$(this).find("span").html()+e}),t=t.slice(0,-1),c.attributes[r.attr("name")]=t;break;case"multiple-select":r=d.find("[name]"),t=r.val()?r.val().join(","):"",c.attributes[r.attr("name")]=t;break;default:r=d.find("[name]"),c.attributes[r.attr("name")]=r.val()}}),o.find(".content-elements").length?(o.find(".cv-builder-piece").each(function(){i+=$(this).val()}),c.content=i):o.find('[name="shortcode_content"]')&&(c.content=o.find('[name="shortcode_content"]').val()),c=JSON.stringify(c);var s={submitted:c,editor:e,action:"cv_ajax_render_shortcode"};t.data("cv-template-builder").startLoading(),$.ajax({type:"POST",url:cv_composer_localize.ajax_url,data:s,success:function(e){wpActiveEditor=a,send_to_editor(e),t.data("cv-template-builder").doneLoading()}})}})})}})})}},t.ready(function(){t.data("cv-shortcode-composer",new $.CVComposer)})}(jQuery);