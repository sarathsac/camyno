!function($){"use strict";var e=$(document);e.ready(function(){var e=$($("#cv-tmpl-format-settings").html());e.insertAfter("#post-formats-select");var a=$("#cv-post-format-meta").children();$('input[name="post_format"]').on("change",function(){var e=$('input[name="post_format"]:checked').val();e||(e="standard"),a.removeClass("is-active"),a.filter('[data-format="'+e+'"]').addClass("is-active")}).trigger("change"),$(".cv-file-input").each(function(){var e=$(this),a=e.attr("id"),t,r=$('.cv-select-file[data-sync="'+a+'"]'),o=$('.cv-remove-file[data-sync="'+a+'"]'),l=r.data("type");e.on("change keyup",function(){t=e.val(),t?(r.hide(),o.show()):(r.show(),o.hide())}).trigger("change"),o.on("click",function(a){a.stopImmediatePropagation(),e.val("").trigger("change")}),r.on("click",function(a){a.stopImmediatePropagation();var t=wp.media({title:"Select a File",button:{text:"Use This File"},library:{type:l},multiple:!1});t.on("select",function(){var a=t.state().get("selection").first().toJSON(),r=a.url;e.val(r).trigger("change")}),t.open()})}),$("#cv-video-format-source").on("change",function(){var e=$(this).val();$("[data-video-source]").hide().filter('[data-video-source="'+e+'"]').show()}).trigger("change"),$("#cv-gallery-format-ids").on("change",function(){var e=$(this).val();if(!e)return $("#cv-gallery-format-preview").html(""),$("#cv-gallery-format-controls").find(".cv-format-meta-manage-gallery").show(),void $("#cv-gallery-format-controls").find(".cv-format-meta-remove-gallery").hide();$("#cv-gallery-format-controls").find(".cv-format-meta-manage-gallery").hide(),$("#cv-gallery-format-controls").find(".cv-format-meta-remove-gallery").show();var a={action:"cv_ajax_render_format_gallery",input:$(this).val()};$.ajax({type:"POST",url:cv_formats_meta_localize.ajax_url,data:a,error:function(){alert(cv_formats_meta_localize.gallery_error)},success:function(e){0===e?alert(cv_formats_meta_localize.ajax_logged_out):"-1"===e?alert(cv_formats_meta_localize.ajax_nonce_error):$("#cv-gallery-format-preview").html(e)}})}),$(".cv-format-meta-remove-gallery").on("click",function(){var e=$("#cv-gallery-format-ids");e.val("").trigger("change")}),$(".cv-format-meta-manage-gallery").on("click",function(){var e=$("#cv-gallery-format-ids"),a=e.val()?!1:!0,t;if(!a){var r=e.val(),o={orderby:"post__in",order:"ASC",type:"image",perPage:-1,post__in:r.split(",")},l=wp.media.query(o);t=new wp.media.model.Selection(l.models,{props:l.props.toJSON(),multiple:!0})}var i=a?"gallery-library":"gallery-edit",c=wp.media({frame:"post",state:i,library:{type:"image"},selection:t});c.on("select update insert",function(a){var t=[];$.each(a.models,function(e,a){t.push(a.id)}),t=t.join(","),e.val(t).trigger("change")}),c.on("close",function(){$("body").removeClass("cv-gallery-editor-modal-active")}),$("body").addClass("cv-gallery-editor-modal-active"),c.open()})})}(jQuery);